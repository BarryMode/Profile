#!/usr/bin/env bash

#==============================================================================#
# Defaults
#==============================================================================#

# Enable aliases to be sudoed
alias sudo='sudo '

# Easier navigation
alias ..="cd .."
alias ...="cd ../.."
alias ....="cd ../../.."
alias .....="cd ../../../.."

# Make directories recursively (ex. `my/tree` will make both folders)
alias mkdir="mkdir -p"

alias python=/usr/local/bin/python3
alias pip=/usr/local/bin/pip3

#==============================================================================#
# Rust Replacements
#==============================================================================#

alias du="dust"
alias ls="exa"
# alias cat="bat"
# alias find="fd"
# alias grep="ripgrep"
# alias sed="sd"
alias top="ytop"
alias tree="exa -T"

#==============================================================================#
# General
#==============================================================================#

# Persistent sudo
alias sama="sudo -v; while true; do sudo -n true; sleep 60; kill -0 \"$$\" || exit; done 2>/dev/null &"

alias whereami="hostname"

# Opens current directory in Finder
alias f="open -a Finder ./"

# Lock the screen (when going AFK)
alias afk="/System/Library/CoreServices/Menu\ Extras/User.menu/Contents/Resources/CGSession -suspend"

# Show, hide, lock, or unlock file
alias show="chflags nohidden"
alias hide="chflags hidden"
alias lock="chflags uchg"
alias unlock="chflags nouchg"
# Show, hide, lock, or unlock files recursively
# `hide_all folder` would hide the folder and all files within it
alias show_all="chflags -R nohidden"
alias hide_all="chflags -R hidden"
alias lock_all="chflags -R uchg"
alias unlock_all="chflags -R nouchg"
# Show/hide symlinks without hiding the destination
alias show_alias="chflags -h nohidden"
alias hide_alias="chflags -h hidden"

#==============================================================================#
# Maintenance
#==============================================================================#

# update: Get macOS Software Updates, update packages, and general cleanup
# TODO: implement this? https://github.com/fwartner/mac-cleanup/blob/master/cleanup.sh
alias update='~//update.sh'

# Update dotfiles
alias update_dotfiles='~//dotfiles/install.sh'

# Update all git repos in this directory
alias update_repos='for d in *; do pushd $d && git pull && popd; done'

# Update custom symlinks
alias update_symlinks='~//update:symlinks.sh'

# Clean up LaunchServices to remove duplicates in the "Open With" menu
alias lscleanup="/System/Library/Frameworks/CoreServices.framework/Frameworks/LaunchServices.framework/Support/lsregister -kill -r -domain local -domain system -domain user && killall Finder"

# Recursively delete `.DS_Store` files
alias dscleanup="find . -type f -name '.DS_Store' -ls -delete; killall Finder"

# Clear clipboard
alias clearclipboard="pbcopy < /dev/null"

# Clear cache
alias clearcache="
  rm -rf .cache
  rm -rf .composer/cache
  rm -rf .expo/*cache
  rm -rf .gradle/caches
  rm -rf ~/Library/Application\ Support/Keybase/kbfs_block_cache
  rm -rf ~/Library/Application\ Support/Google/DriveFS/cef_cache/Cache
  rm -rf ~/Library/Developer/CoreSimulator
"

# Clear Apple's System Logs to improve shell startup speed.
# Clear download history from quarantine.
alias clearlogs="sudo rm -rfv /private/var/log/asl/*.asl; sqlite3 ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV* 'delete from LSQuarantineEvent'"

# remove empty directories
alias ded="find . -type d -empty -delete"

# Empty the Trash on all mounted volumes and the main HDD.
alias emptytrash="sudo rm -rfv /Volumes/*/.Trashes; sudo rm -rfv ~/.Trash"

# Reset Gatekeeper Rules
alias reset_gatekeeper="sudo spctl --reset-default"

# Disable Gatekeeper
alias disable_gatekeeper="sudo spctl --master-disable"

# Enable Gatekeeper
alias enable_gatekeeper="sudo spctl --master-enable"

#==============================================================================#
# Internet
#==============================================================================#

# IP addresses
alias ip="dig +short myip.opendns.com @resolver1.opendns.com"
alias hostip="dig +short"
alias localip="ipconfig getifaddr en0"
# Downloads list of links from source input and preserves directory structure
alias wgetlist="wget -r --no-remove-listing -i"
# wget settings for mirroring
alias mirror='wget -cmkEpnp'
# Flush Directory Service cache
alias flush="sudo killall -HUP mDNSResponder;sudo killall mDNSResponderHelper;sudo dscacheutil -flushcache"

#==============================================================================#
# Terminal
#==============================================================================#

# Reload the shell (i.e. invoke as a login shell)
alias reload="exec $SHELL -l"

# Print each PATH entry on a separate line
alias path='echo -e ${PATH//:/\\n}'

#==============================================================================#
# Other
#==============================================================================#

# Merge PDF files, preserving hyperlinks
# `mergepdf -o output.pdf input{1,2,3}.pdf`
alias mergepdf='gs -q -dNOPAUSE -dBATCH -sDEVICE=pdfwrite -sOutputFile=_merged.pdf'

# Convert plist files to xml or binary
alias plist_to_xml='plutil -convert xml1'
alias plist_to_binary='plutil -convert binary1'

# Relink all brew links
alias brew_relink="brew list -1 | while read line; do brew unlink $line; brew link $line; done"

# When audio isn't working
alias fix_audio='sudo pkill coreaudiod'

# When an app tells you "This app is damaged and can't be opened. You should move it to the trash."
alias fix_apps='xattr -rc'

#==============================================================================#
# Shortcuts
#==============================================================================#

# ⌘K
alias c="printf '\033c\e[3J'"

# m stands for metadata
# `m -j file` outputs json
alias m='exiftool'

# Reload
alias r="reload"
